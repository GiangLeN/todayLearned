# Cigar understanding

Format

Col 	Type 	Description
1 	string 	Query sequence name
2 	int 	Query sequence length
3 	int 	Query start (0-based; BED-like; closed)
4 	int 	Query end (0-based; BED-like; open)
5 	char 	Relative strand: "+" or "-"
6 	string 	Target sequence name
7 	int 	Target sequence length
8 	int 	Target start on original strand (0-based)
9 	int 	Target end on original strand (0-based)
10 	int 	Number of residue matches
11 	int 	Alignment block length
12 	int 	Mapping quality (0-255; 255 for missing)

For this paf line
NHP00715|Mamu-KIR1D*006|837	837	33	837	+	R02034_hap2_chr19_KIR	242067	148361	157500	721	822	0	NM:i:101	ms:i:376	AS:i:242	nn:i:0	ts:A:+	tp:A:P	cm:i:73	s1:i:359	s2:i:359	de:f:0.1021	rl:i:0	cg:Z:37M2314N113M2I3M2D182M4537N51M911N60M3I42M461N53M99N163M16D95M

Query is NHP00715|Mamu-KIR1D*006|837
Query length 837
Query start mapped coordinates 33
Query end mapped coordinates 837
Strand +
Target is R02034_hap2_chr19_KIR
Target length is 242067 (Where does this number come from?)
Target start mapped coordinates 148361
Target end mapped coordinates 157500 (Target diff onlt 9139 bp)
Cigar string cg:Z:37M2314N113M2I3M2D182M4537N51M911N60M3I42M461N53M99N163M16D95M

```
bedtools getfasta -fi mamu_kir_gen_2501.fasta -bed query_coords
```

Check 37 Matched from 33 to 70 with

```
>NHP00715|Mamu-KIR1D*006|837:33-70
GGGTTCTTCTTGGTCCAGAGGGCCTGTCCACACATGG
>NHP00715|Mamu-KIR1D*006|837:32-70
TGGGTTCTTCTTGGTCCAGAGGGCCTGTCCACACATGG
>NHP00715|Mamu-KIR1D*006|837:32-71
TGGGTTCTTCTTGGTCCAGAGGGCCTGTCCACACATGGG
>NHP00715|Mamu-KIR1D*006|837:33-71
GGGTTCTTCTTGGTCCAGAGGGCCTGTCCACACATGGG
```

```
bedtools getfasta -fi R02034_hybridPN_denovo_hap2_GCF_003339765_KIR_intact.fa -bed target_coords
```
```
>R02034_hap2_chr19_KIR:148361-148398
GGGTTCTTCTTGATCCAGAGGGCCTGTCCACACACGG
>R02034_hap2_chr19_KIR:148360-148398
AGGGTTCTTCTTGATCCAGAGGGCCTGTCCACACACGG
>R02034_hap2_chr19_KIR:148360-148399
AGGGTTCTTCTTGATCCAGAGGGCCTGTCCACACACGGG
>R02034_hap2_chr19_KIR:148361-148399
GGGTTCTTCTTGATCCAGAGGGCCTGTCCACACACGGG
```
Coords with the start -1 are eliminated

Next we have 2314N so this are non matching, cant be found on the query
148398 + 2314 = 150712
150712 + 113 = 150825
R02034_hap2_chr19_KIR   150712  150825
R02034_hap2_chr19_KIR   150712  150826
R02034_hap2_chr19_KIR   150713  150825
R02034_hap2_chr19_KIR   150713  150826

bedtools getfasta -fi R02034_hybridPN_denovo_hap2_GCF_003339765_KIR_intact.fa -bed target_coords 
>R02034_hap2_chr19_KIR:150712-150825
GAGTCCACAGAAAACCTTCCCTCCTGGCCCTCCCAGGTCCCCTGGTGAAATCAGGAGAGACGGTCACCCTACAATGTTCCTCAGATATCGTGTTTGAGCACTTCTTTCTGCAC
>R02034_hap2_chr19_KIR:150712-150826
GAGTCCACAGAAAACCTTCCCTCCTGGCCCTCCCAGGTCCCCTGGTGAAATCAGGAGAGACGGTCACCCTACAATGTTCCTCAGATATCGTGTTTGAGCACTTCTTTCTGCACA
>R02034_hap2_chr19_KIR:150713-150825
AGTCCACAGAAAACCTTCCCTCCTGGCCCTCCCAGGTCCCCTGGTGAAATCAGGAGAGACGGTCACCCTACAATGTTCCTCAGATATCGTGTTTGAGCACTTCTTTCTGCAC
>R02034_hap2_chr19_KIR:150713-150826
AGTCCACAGAAAACCTTCCCTCCTGGCCCTCCCAGGTCCCCTGGTGAAATCAGGAGAGACGGTCACCCTACAATGTTCCTCAGATATCGTGTTTGAGCACTTCTTTCTGCACA

bedtools getfasta -fi mamu_kir_gen_2501.fasta -bed query_coords
>NHP00715|Mamu-KIR1D*006|837:70-183
GAGTCCACAGAAAACCTTCCCTCCTGGCCCTCCCAGGTCCCCTGGTGAAATCAGAAGAGACGGTCATCCTGCAGTGCTGGTCAGATATCAAGTTTGGGCACTTCCTTCTGCAC
>NHP00715|Mamu-KIR1D*006|837:70-184
GAGTCCACAGAAAACCTTCCCTCCTGGCCCTCCCAGGTCCCCTGGTGAAATCAGAAGAGACGGTCATCCTGCAGTGCTGGTCAGATATCAAGTTTGGGCACTTCCTTCTGCACC
>NHP00715|Mamu-KIR1D*006|837:71-183
AGTCCACAGAAAACCTTCCCTCCTGGCCCTCCCAGGTCCCCTGGTGAAATCAGAAGAGACGGTCATCCTGCAGTGCTGGTCAGATATCAAGTTTGGGCACTTCCTTCTGCAC
>NHP00715|Mamu-KIR1D*006|837:71-184
AGTCCACAGAAAACCTTCCCTCCTGGCCCTCCCAGGTCCCCTGGTGAAATCAGAAGAGACGGTCATCCTGCAGTGCTGGTCAGATATCAAGTTTGGGCACTTCCTTCTGCACC

Elimiate end +1

Query 
33 70 183
GGGTTCTTCTTGGTCCAGAGGGCCTGTCCACACATGG GAGTCCACAGAAAACCTTCCCTCCTGGCCCTCCCAGGTCCCCTGGTGAAATCAGAAGAGACGGTCATCCTGCAGTGCTGGTCAGATATCAAGTTTGGGCACTTCCTTCTGCAC
33 71 183
GGGTTCTTCTTGGTCCAGAGGGCCTGTCCACACATGGG AGTCCACAGAAAACCTTCCCTCCTGGCCCTCCCAGGTCCCCTGGTGAAATCAGAAGAGACGGTCATCCTGCAGTGCTGGTCAGATATCAAGTTTGGGCACTTCCTTCTGCAC

Target 
148361-148398 150712-150825
GGGTTCTTCTTGATCCAGAGGGCCTGTCCACACACGG GAGTCCACAGAAAACCTTCCCTCCTGGCCCTCCCAGGTCCCCTGGTGAAATCAGGAGAGACGGTCACCCTACAATGTTCCTCAGATATCGTGTTTGAGCACTTCTTTCTGCAC
148361-148399 150713-150825
GGGTTCTTCTTGATCCAGAGGGCCTGTCCACACACGGG AGTCCACAGAAAACCTTCCCTCCTGGCCCTCCCAGGTCCCCTGGTGAAATCAGGAGAGACGGTCACCCTACAATGTTCCTCAGATATCGTGTTTGAGCACTTCTTTCTGCAC

Looking at insert
>NHP00715|Mamu-KIR1D*006|837:70-186
GAGTCCACAGAAAACCTTCCCTCCTGGCCCTCCCAGGTCCCCTGGTGAAATCAGAAGAGACGGTCATCCTGCAGTGCTGGTCAGATATCAAGTTTGGGCACTTCCTTCTGCACCAA
GAGTCCACAGAAAACCTTCCCTCCTGGCCCTCCCAGGTCCCCTGGTGAAATCAGAAGAGACGGTCATCCTGCAGTGCTGGTCAGATATCAAGTTTGGGCACTTCCTTCTGCAC
>NHP00715|Mamu-KIR1D*006|837:70-187
GAGTCCACAGAAAACCTTCCCTCCTGGCCCTCCCAGGTCCCCTGGTGAAATCAGAAGAGACGGTCATCCTGCAGTGCTGGTCAGATATCAAGTTTGGGCACTTCCTTCTGCACCAAG
>NHP00715|Mamu-KIR1D*006|837:71-186
AGTCCACAGAAAACCTTCCCTCCTGGCCCTCCCAGGTCCCCTGGTGAAATCAGAAGAGACGGTCATCCTGCAGTGCTGGTCAGATATCAAGTTTGGGCACTTCCTTCTGCACCAA
>NHP00715|Mamu-KIR1D*006|837:71-187
AGTCCACAGAAAACCTTCCCTCCTGGCCCTCCCAGGTCCCCTGGTGAAATCAGAAGAGACGGTCATCCTGCAGTGCTGGTCAGATATCAAGTTTGGGCACTTCCTTCTGCACCAAG

>R02034_hap2_chr19_KIR:150712-150830
GAGTCCACAGAAAACCTTCCCTCCTGGCCCTCCCAGGTCCCCTGGTGAAATCAGGAGAGACGGTCACCCTACAATGTTCCTCAGATATCGTGTTTGAGCACTTCTTTCTGCACAGTGA
GAGTCCACAGAAAACCTTCCCTCCTGGCCCTCCCAGGTCCCCTGGTGAAATCAGGAGAGACGGTCACCCTACAATGTTCCTCAGATATCGTGTTTGAGCACTTCTTTCTGCAC
>R02034_hap2_chr19_KIR:150712-150831
GAGTCCACAGAAAACCTTCCCTCCTGGCCCTCCCAGGTCCCCTGGTGAAATCAGGAGAGACGGTCACCCTACAATGTTCCTCAGATATCGTGTTTGAGCACTTCTTTCTGCACAGTGAG
>R02034_hap2_chr19_KIR:150713-150830
AGTCCACAGAAAACCTTCCCTCCTGGCCCTCCCAGGTCCCCTGGTGAAATCAGGAGAGACGGTCACCCTACAATGTTCCTCAGATATCGTGTTTGAGCACTTCTTTCTGCACAGTGA
>R02034_hap2_chr19_KIR:150713-150831
AGTCCACAGAAAACCTTCCCTCCTGGCCCTCCCAGGTCCCCTGGTGAAATCAGGAGAGACGGTCACCCTACAATGTTCCTCAGATATCGTGTTTGAGCACTTCTTTCTGCACAGTGAG

>NHP00715|Mamu-KIR1D*006|837:70-188
GAGTCCACAGAAAACCTTCCCTCCTGGCCCTCCCAGGTCCCCTGGTGAAATCAGAAGAGACGGTCATCCTGCAGTGCTGGTCAGATATCAAGTTTGGGCACTTCCTTCTGCACCAAGT
>GAGTCCACAGAAAACCTTCCCTCCTGGCCCTCCCAGGTCCCCTGGTGAAATCAGAAGAGACGGTCATCCTGCAGTGCTGGTCAGATATCAAGTTTGGGCACTTCCTTCTGCAC
>NHP00715|Mamu-KIR1D*006|837:70-189
GAGTCCACAGAAAACCTTCCCTCCTGGCCCTCCCAGGTCCCCTGGTGAAATCAGAAGAGACGGTCATCCTGCAGTGCTGGTCAGATATCAAGTTTGGGCACTTCCTTCTGCACCAAGTG
>NHP00715|Mamu-KIR1D*006|837:71-188
AGTCCACAGAAAACCTTCCCTCCTGGCCCTCCCAGGTCCCCTGGTGAAATCAGAAGAGACGGTCATCCTGCAGTGCTGGTCAGATATCAAGTTTGGGCACTTCCTTCTGCACCAAGT
>NHP00715|Mamu-KIR1D*006|837:71-189
AGTCCACAGAAAACCTTCCCTCCTGGCCCTCCCAGGTCCCCTGGTGAAATCAGAAGAGACGGTCATCCTGCAGTGCTGGTCAGATATCAAGTTTGGGCACTTCCTTCTGCACCAAGTG
